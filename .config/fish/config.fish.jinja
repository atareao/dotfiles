fish_add_path -g ~/.cargo/bin ~/.local/bin ~/go/bin/ ~/bin /usr/local/bin

if status is-interactive
    # Commands to run in interactive sessions can go here
    # remove welcome message
    set -g fish_greeting
    # set starship config
    set -gx STARSHIP_CONFIG ~/.config/starship/starship.toml
    # set neovim as editor
    set -gx EDITOR nvim
    # Theme
    fish_config theme choose "ayu Mirage"
    # starship
    starship init fish | source
    # zoxide
    zoxide init fish | source
    # direnv
    direnv hook fish | source
    # uv
    uv generate-shell-completion fish | source
    # fclones
    fclones complete fish | source
    # variables
    {% if env.MACHINE == "archi" -%}
    set -gx MACHINE archi
    set -gx TERM kitty
    set -gx SOPS_AGE_KEY_FILE "$HOME/.secrets/sops/age/key.txt"
    set -l STORE "$HOME/.secrets/secrets.yml"
    if test -f $STORE
        set -l pattern "anthropic_token|gemini_api_key|morph_token"
        sops -d $STORE | yq -r 'to_entries | .[] | select(.key != "sops") | .key + " " + (.value | tostring)' | grep -E "^($pattern) " | while read -l key value
            set -l key_up (string upper $key)
            set -gx $key_up $value
        end
    end
    {% elif env.MACHINE == "termux" -%}
    set -gx MACHINE termux
    {% endif -%}
end

# pnpm
set -gx PNPM_HOME "/home/lorenzo/.local/share/pnpm"
if not string match -q -- $PNPM_HOME $PATH
  set -gx PATH "$PNPM_HOME" $PATH
end
# pnpm end

# Added by LM Studio CLI (lms)
set -gx PATH $PATH /home/lorenzo/.lmstudio/bin
# End of LM Studio CLI section

